---
title: "Homework 2"
author: "Ekaterina Hofrenning"
date: '2023-09-27'
output: github_document
---

```{r}
library(tidyverse)
library(lubridate)
```

# Problem 1

This problem uses the FiveThirtyEight data; these data were gathered to create the interactive graphic on this page. In particular, we’ll use the data in pols-month.csv, unemployment.csv, and snp.csv. Our goal is to merge these into a single data frame using year and month as keys across datasets.

First, clean the data in pols-month.csv. Use separate() to break up the variable mon into integer variables year, month, and day; replace month number with month name; create a president variable taking values gop and dem, and remove prez_dem and prez_gop; and remove the day variable.

```{r}
pols <- 
  read.csv("./data/fivethirtyeight_datasets/pols-month.csv") %>%  #read pols-month data
  separate(mon, sep = "-", into = c("year", "month", "day")) %>% # y/m/d variables
  mutate_at(c("year", "month", "day"), as.numeric) %>% # convert to numeric
  mutate(month = month.abb[month], # jan-dec
         president = case_when(prez_gop == 1 ~ "gop", prez_dem == 1 ~ "dem")) %>% # combine into president
  select(-c(prez_dem, prez_gop, day))
```

Second, clean the data in snp.csv using a similar process to the above. For consistency across datasets, arrange according to year and month, and organize so that year and month are the leading columns.

```{r}
snp <- 
  read.csv("./data/fivethirtyeight_datasets/snp.csv") %>%
  separate(date, sep = "/", into = c("month", "day", "year")) %>%  # m/d/y variables
  mutate_at(c("year", "month", "day"), as.numeric) %>% # convert to numeric
  mutate(month = month.abb[month]) %>% # jan-dec
  select(-day) %>% # remove day
  relocate(year, month)
```

Third, tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.

```{r}
unemployment <- 
  read.csv("./data/fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(names_to = "month", cols = Jan:Dec) %>% # switch to long format
  rename(year = Year) # match format
```

Join the datasets by merging snp into pols, and merging unemployment into the result.

```{r}
merge1 <- left_join(pols, snp, by = c("year", "month"))
merge2 <- left_join(merge1, unemployment, by = c("year", "month"))
```


Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

  

Note: we could have used a date variable as a key instead of creating year and month keys; doing so would help with some kinds of plotting, and be a more accurate representation of the data. Date formats are tricky, though. For more information check out the lubridate package in the tidyverse.

